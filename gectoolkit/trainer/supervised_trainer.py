# -*- encoding: utf-8 -*-
# @Author: Yunshi Lan
# @Time: 2023/02/10 14：50
# @File: supervised_trainer.py

import os
import time
import math
from tqdm import tqdm

import torch
from ray import tune
import numpy as np
from collections import defaultdict

from gectoolkit.trainer.abstract_trainer import AbstractTrainer
from gectoolkit.utils.enum_type import DatasetType
from gectoolkit.utils.utils import time_since
from gectoolkit.utils.file_reader import write_json_data


class SupervisedTrainer(AbstractTrainer):
    """supervised trainer, used to implement training, testing, parameter searching in supervised learning.
    
    example of instantiation:
        
        >>> trainer = SupervisedTrainer(config, model, dataloader, evaluator)

        for training:
            
            >>> trainer.fit()
        
        for testing:
            
            >>> trainer.test()
        
        for parameter searching:

            >>> trainer.param_search()
    """

    def __init__(self, config, model, dataloader, evaluator):
        """
        Args:
            config (config): An instance object of Config, used to record parameter information.
            model (Model): An object of deep-learning model. 
            dataloader (Dataloader): dataloader object.
            evaluator (Evaluator): evaluator object.
        """
        super().__init__(config, model, dataloader, evaluator)
        self._build_optimizer()

    def _build_optimizer(self):
        self.optimizer = torch.optim.Adam(self.model.parameters(), lr=self.config["learning_rate"])

    def _save_checkpoint(self):
        check_pnt = {
            "model": self.model.state_dict(),
            "optimizer": self.optimizer.state_dict(),
            "start_epoch": self.epoch_i,
            "best_valid_precision": self.best_valid_precision,
            "best_valid_recall": self.best_valid_recall,
            "best_valid_f": self.best_valid_f,
            "best_test_precision": self.best_test_precision,
            "best_test_recall": self.best_test_recall,
            "best_test_f": self.best_test_f,
            "best_folds_accuracy": self.best_folds_accuracy,
        }
        checkpoint_dir = self.config['checkpoint_dir']
        if not os.path.abspath(checkpoint_dir):
            checkpoint_dir = os.path.join(os.getcwd(), checkpoint_dir)
        if not os.path.exists(checkpoint_dir):
            os.mkdir(checkpoint_dir)
        save_dir = checkpoint_dir
        if not os.path.exists(save_dir):
            os.mkdir(save_dir)
        model_file = os.path.join(save_dir, 'trainer_checkpoint.pth')
        torch.save(check_pnt, model_file)
        self.config.save_config(save_dir)
        self.config.save_config(checkpoint_dir)

    def _load_checkpoint(self):
        print("load checkpoint")
        load_dir = self.config['checkpoint_dir']
        model_file = os.path.join(load_dir, 'trainer_checkpoint.pth')
        check_pnt = torch.load(model_file, map_location=self.config["map_location"])
        # mapping = {'text_field_embedder.token_embedder_bert.bert_model.embeddings.position_ids': 'encoder.token_embedder_bert.transformer_model.embeddings.position_ids', 'text_field_embedder.token_embedder_bert.bert_model.embeddings.word_embeddings.weight': 'encoder.token_embedder_bert.transformer_model.embeddings.word_embeddings.weight', 'text_field_embedder.token_embedder_bert.bert_model.embeddings.position_embeddings.weight': 'encoder.token_embedder_bert.transformer_model.embeddings.position_embeddings.weight', 'text_field_embedder.token_embedder_bert.bert_model.embeddings.token_type_embeddings.weight': 'encoder.token_embedder_bert.transformer_model.embeddings.token_type_embeddings.weight', 'text_field_embedder.token_embedder_bert.bert_model.embeddings.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.embeddings.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.embeddings.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.embeddings.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.0.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.1.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.2.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.3.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.4.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.5.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.6.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.7.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.8.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.9.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.10.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.output.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.output.dense.bias', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.bert_model.encoder.layer.11.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.bert_model.pooler.dense.weight': 'encoder.token_embedder_bert.transformer_model.pooler.dense.weight', 'text_field_embedder.token_embedder_bert.bert_model.pooler.dense.bias': 'encoder.token_embedder_bert.transformer_model.pooler.dense.bias'}
        # mapping = {'text_field_embedder.token_embedder_bert.transformer_model.embeddings.position_ids': 'encoder.token_embedder_bert.transformer_model.embeddings.position_ids', 'text_field_embedder.token_embedder_bert.transformer_model.embeddings.word_embeddings.weight': 'encoder.token_embedder_bert.transformer_model.embeddings.word_embeddings.weight', 'text_field_embedder.token_embedder_bert.transformer_model.embeddings.position_embeddings.weight': 'encoder.token_embedder_bert.transformer_model.embeddings.position_embeddings.weight', 'text_field_embedder.token_embedder_bert.transformer_model.embeddings.token_type_embeddings.weight': 'encoder.token_embedder_bert.transformer_model.embeddings.token_type_embeddings.weight', 'text_field_embedder.token_embedder_bert.transformer_model.embeddings.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.embeddings.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.embeddings.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.embeddings.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.0.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.0.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.1.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.1.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.2.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.2.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.3.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.3.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.4.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.4.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.5.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.5.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.6.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.6.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.7.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.7.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.8.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.8.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.9.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.9.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.10.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.10.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.11.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.11.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.12.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.12.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.13.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.13.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.14.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.14.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.15.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.15.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.16.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.16.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.17.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.17.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.18.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.18.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.19.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.19.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.20.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.20.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.21.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.21.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.22.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.22.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.attention.self.query.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.attention.self.query.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.attention.self.query.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.attention.self.query.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.attention.self.key.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.attention.self.key.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.attention.self.key.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.attention.self.key.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.attention.self.value.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.attention.self.value.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.attention.self.value.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.attention.self.value.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.attention.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.attention.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.attention.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.attention.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.attention.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.attention.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.attention.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.attention.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.intermediate.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.intermediate.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.intermediate.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.intermediate.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.output.dense.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.output.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.output.dense.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.output.dense.bias', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.output.LayerNorm.weight': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.output.LayerNorm.weight', 'text_field_embedder.token_embedder_bert.transformer_model.encoder.layer.23.output.LayerNorm.bias': 'encoder.token_embedder_bert.transformer_model.encoder.layer.23.output.LayerNorm.bias', 'text_field_embedder.token_embedder_bert.transformer_model.pooler.dense.weight': 'encoder.token_embedder_bert.transformer_model.pooler.dense.weight', 'text_field_embedder.token_embedder_bert.transformer_model.pooler.dense.bias': 'encoder.token_embedder_bert.transformer_model.pooler.dense.bias'}
        # new_check_pnt = {}
        # for key in mapping:
        #     new_check_pnt[mapping[key]] = check_pnt[key]
        # new_check_pnt['tag_labels_projection_layer._module.weight'] = check_pnt['tag_labels_projection_layer._module.weight']
        # new_check_pnt['tag_labels_projection_layer._module.bias'] = check_pnt['tag_labels_projection_layer._module.bias']
        # new_check_pnt['tag_detect_projection_layer._module.weight'] = check_pnt['tag_detect_projection_layer._module.weight']
        # new_check_pnt['tag_detect_projection_layer._module.bias'] = check_pnt['tag_detect_projection_layer._module.bias']
        # self.model.load_state_dict(new_check_pnt)
        # load parameter of model
        self.model.load_state_dict(check_pnt["model"])
        # load parameter of optimizer
        self.optimizer.load_state_dict(check_pnt["optimizer"])
        # other parameter
        self.start_epoch = check_pnt["start_epoch"]
        self.best_valid_precision = check_pnt["best_valid_precision"]
        self.best_valid_recall = check_pnt["best_valid_recall"]
        self.best_valid_f = check_pnt["best_valid_f"]
        self.best_test_precision = check_pnt["best_test_precision"]
        self.best_test_recall = check_pnt["best_test_recall"]
        self.best_test_f = check_pnt["best_test_f"]
        self.best_folds_accuracy = check_pnt["best_folds_accuracy"]

    def _save_predict(self, predict_out, test_f):
        save_dir = self.config['checkpoint_dir']
        if not os.path.exists(save_dir):
            os.mkdir(save_dir)
        filename = 'predicts_F0.5=' + '%2.3f' % test_f + '.json'
        predict_file = os.path.join(save_dir, filename)
        write_json_data(predict_out, predict_file)

    def _idx2word_2idx(self, batch_equation):
        batch_size, length = batch_equation.size()
        batch_equation_ = []
        for b in range(batch_size):
            equation = []
            for idx in range(length):
                equation.append(self.dataloader.dataset.out_symbol2idx[ \
                                    self.dataloader.dataset.in_idx2word[ \
                                        batch_equation[b, idx]]])
            batch_equation_.append(equation)
        batch_equation_ = torch.LongTensor(batch_equation_).to(self.config["device"])
        return batch_equation_

    def recover_num(self, rewrite_list, target_batch, replaced_symbols):
        new_rewrite_list = []
        source_unk_list = [w for w in target_batch if w not in self.dataloader.pretrained_tokenizer.vocab]
        unk_id = 0
        if len(replaced_symbols) == 0:
            for w in rewrite_list:
                if w == self.dataloader.pretrained_tokenizer.unk_token and unk_id < len(source_unk_list):
                    new_rewrite_list += [source_unk_list[unk_id]]
                    unk_id += 1
                else:
                    new_rewrite_list += [w]
        else:
            for w in rewrite_list:
                if w == self.dataloader.pretrained_tokenizer.unk_token:
                    new_rewrite_list += [replaced_symbols[unk_id]]
                    unk_id += 1
                else:
                    new_rewrite_list += [w]

        ret_list = []
        for w in new_rewrite_list:
            new_w = w.replace('##', '')
            ret_list.append(new_w)

        return ret_list

    def _train_batch(self, batch):
        batch_loss = self.model(batch, self.dataloader)
        return batch_loss

    def _eval_batch(self, batch):
        gen_start = time.time()
        '''
        batch_loss = self.model(batch, self.dataloader)
        dec_f1s, cor_f1s = [batch_loss["loss"].item()], [batch_loss["loss"].item()]
        '''
        self.dataloader.replaced_symbols = []
        test_out, target = self.model.model_test(batch, self.dataloader)
        batch_size = len(test_out)
        precisions = []
        recalls = []
        F_list = []
        predict_out = []

        for idx in range(batch_size):
            precision, recall, F = self.evaluator.measure(batch['source_list_batch'][idx],  # I changed this !!!
                                                          batch['target_list_batch'][idx],
                                                          test_out[idx])
            precisions.append(precision)
            recalls.append(recall)
            F_list.append(F)

            symbols = self.dataloader.replaced_symbols

            if self.config['model'] != 'GECToR':
                rewrite_list = self.recover_num(self.dataloader.pretrained_tokenizer.convert_ids_to_tokens(test_out[idx]),
                                                batch['target_batch'][idx], symbols)

                # print(rewrite_list); exit()
                if self.config["language"] != 'zh':
                    pred_out = {'Wrong': batch['source_batch'][idx],
                                'Target': batch['target_batch'][idx],
                                'Rewrite': ' '.join(rewrite_list)}
                else:
                    pred_out = {'Wrong': batch['source_batch'][idx],
                                'Target': batch['target_batch'][idx],
                                'Rewrite': ''.join(rewrite_list)}

            else:
                pred_out = {'Wrong': ' '.join(batch['source_batch'][idx]),
                            'Target': ' '.join(batch['target_batch'][idx]),
                            'Rewrite': ' '.join(test_out[idx])}
            predict_out.append(pred_out)

        return predict_out, precisions, recalls, F_list

    def _train_epoch(self):
        epoch_start_time = time.time()
        loss_total = defaultdict(list)
        self.model.train()
        for batch_idx, _ in enumerate(self.dataloader.load_data(DatasetType.Train)):
            # if batch_idx == 5000: break
            self.batch_idx = batch_idx + 1
            batch = self.dataloader.load_next_batch(DatasetType.Train)
            self.optimizer.zero_grad()
            batch_loss = self._train_batch(batch)

            for k in batch_loss:
                if 'loss' in k:
                    loss_total[k] += [batch_loss[k]]

            batch_loss["loss"].backward()
            torch.nn.utils.clip_grad_norm_(self.model.parameters(), 1.0)
            self.optimizer.step()

        self.optimizer.zero_grad()
        self.model.zero_grad()
        epoch_time_cost = time_since(time.time() - epoch_start_time)
        return loss_total, epoch_time_cost

    def fit(self):
        """train model.
        """
        train_batch_size = self.config["train_batch_size"]
        epoch_nums = self.config["epoch_nums"]

        self.train_batch_nums = math.ceil(self.dataloader.trainset_nums / train_batch_size)

        self.logger.info("start training...")
        for epo in tqdm(range(self.start_epoch, epoch_nums), desc='train process '):
            self.epoch_i = epo + 1
            self.model.train()
            loss_total, train_time_cost = self._train_epoch()

            if epo % self.display_train_step == 0 or epo > epoch_nums - 5:
                logging_output = ""
                for l in loss_total:
                    logging_output += " " + l + " |"
                    logging_output += "[%2.3f]" % (
                            np.sum(torch.tensor(loss_total[l]).numpy()) * 1. / self.train_batch_nums)

                self.logger.info("epoch [%3d] train time %s | " % (self.epoch_i, train_time_cost) + logging_output)

            if epo % self.test_step == 0 or epo > epoch_nums - 5:
                _, valid_precision, valid_recall, valid_F, valid_total, valid_time_cost = self.evaluate(
                    DatasetType.Valid)

                self.logger.info(
                    "---------- valid total [%d] | valid precision [%2.3f] | valid recall [%2.3f] | valid f0.5 [%2.3f] | valid time %s" \
                    % (valid_total, valid_precision, valid_recall, valid_F, valid_time_cost))
                predict_out, test_precision, test_recall, test_F, test_total, test_time_cost = self.evaluate(
                    DatasetType.Test)

                self.logger.info(
                    "---------- test total [%d] | test precision [%2.3f] | test recall [%2.3f] | test f0.5 [%2.3f] | test time %s" \
                    % (test_total, test_precision, test_recall, test_F, test_time_cost))

                if valid_F >= self.best_valid_f:
                    self.best_valid_precision = valid_precision
                    self.best_valid_recall = valid_recall
                    self.best_valid_f = valid_F
                    self.best_test_precision = test_precision
                    self.best_test_recall = test_recall
                    self.best_test_f = test_F
                    self._save_checkpoint()

                self._save_predict(predict_out, valid_F)


            # if epo % 5 == 0:
            #     self._save_checkpoint()
        self.logger.info('''training finished.
                            best valid result: precision [%2.3f] | recall [%2.3f] | F0.5 [%2.3f]
                            best test result : precision [%2.3f] | recall [%2.3f] | F0.5 [%2.3f]''' \
                         % (self.best_valid_precision, self.best_valid_recall, self.best_valid_f, \
                            self.best_test_precision, self.best_test_recall, self.best_test_f))

    def evaluate(self, eval_set):
        """evaluate model.

        Args:
            eval_set (str): [valid | test], the dataset for evaluation.

        Returns:
            tuple(float,float,int,str):
            detection F1, correction F1, count of evaluated datas, formatted time string of evaluation tiume.
        """
        self.model.eval()
        precision = 0
        recall = 0
        F = 0
        eval_total = 0
        predict_out = []

        if eval_set == DatasetType.Valid:
            batch_nums = self.dataloader.validset_batch_nums
        elif eval_set == DatasetType.Test:
            batch_nums = self.dataloader.testset_batch_nums
        else:
            raise ValueError("{} type not in ['valid', 'test'].".format(eval_set))
        test_start_time = time.time()
        for batch_idx in tqdm(range(batch_nums), desc='test {}set'.format(eval_set)):
            batch = self.dataloader.load_next_batch(eval_set)
            pred_out, batch_p, batch_r, batch_f = self._eval_batch(batch)
            precision += np.sum(batch_p)
            recall += np.sum(batch_r)
            F += np.sum(batch_f)
            eval_total += len(batch_p)
            predict_out += pred_out

        test_time_cost = time_since(time.time() - test_start_time)
        return predict_out, precision / eval_total, recall / eval_total, F / eval_total, eval_total, test_time_cost

    # test only模式下调用该函数进行测试
    def test(self):
        """test model.
        """
        self.model.eval()
        # det_f1 = 0
        # cor_f1 = 0
        precision = 0
        recall = 0
        F = 0
        eval_total = 0
        predict_out = []
        test_start_time = time.time()

        for batch in self.dataloader.load_data(DatasetType.Test):
            # pred_out, batch_det_f1, batch_cor_f1 = self._eval_batch(batch)
            # det_f1 += np.sum(batch_det_f1)
            # cor_f1 += np.sum(batch_cor_f1)
            # eval_total += len(batch_det_f1)
            pred_out, batch_p, batch_r, batch_f = self._eval_batch(batch)
            precision += np.sum(batch_p)
            recall += np.sum(batch_r)
            F += np.sum(batch_f)
            eval_total += len(batch_p)
            predict_out += pred_out

        self.best_test_f = F / eval_total
        self.best_test_precision = precision / eval_total
        self.best_test_recall = recall / eval_total
        test_time_cost = time_since(time.time() - test_start_time)
        self.logger.info("test total [%d] | precision [%2.3f] | recall [%2.3f] | f0.5 [%2.3f] | test time %s" \
                         % (eval_total, precision / eval_total, recall / eval_total, F / eval_total, test_time_cost))
        # self._save_output()
        self._save_predict(predict_out, self.best_test_f)
